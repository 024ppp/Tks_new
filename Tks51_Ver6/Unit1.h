//---------------------------------------------------------------------------
#ifndef Unit1H
#define Unit1H
//---------------------------------------------------------------------------
#include <Classes.hpp>
#include <Controls.hpp>
#include <StdCtrls.hpp>
#include <Forms.hpp>
#include <ExtCtrls.hpp>
#include <ComCtrls.hpp>
#include <Chart.hpp>
#include <Series.hpp>
#include <TeeFunci.hpp>
#include <TeEngine.hpp>
#include <TeeProcs.hpp>
#include <Grids.hpp>
#include <Db.hpp>
#include <DBTables.hpp>
//#include "NumberEdit.h"
#include <Clipbrd.hpp>
#include <DB.hpp>
#include "NumberEdit.h"
//---------------------------------------------------------------------------
class TForm1 : public TForm
{
__published:	// IDE 管理のコンポーネント
    TStatusBar *SBr1;
        TPanel *Panel9;
    TButton *BtnF01;
    TButton *BtnF02;
    TButton *BtnF03;
    TButton *BtnF04;
    TButton *BtnF05;
    TButton *BtnF06;
    TButton *BtnF07;
    TButton *BtnF08;
    TButton *BtnF09;
    TButton *BtnF10;
    TButton *BtnF11;
    TButton *BtnF12;
        TLabel *Label18;
        TLabel *Label20;
        TBevel *Bevel1;
        TPanel *Panel20;
        TPanel *Panel2;
    TPanel *PnlBumCode;
    TPanel *PnlBumName;
        TPanel *Panel5;
    TPanel *PnlTanCode;
    TPanel *PnlTanName;
        TPanel *Panel1;
    TStringGrid *SGr1;
        TPanel *Panel19;
        TPanel *Panel12;
        TPanel *Panel13;
        TPanel *Panel14;
        TPanel *Panel15;
        TPanel *Panel17;
        TPanel *Panel21;
        TPanel *Panel8;
        TPanel *Panel23;
    TEdit *EdtCOD3;
        TPanel *Panel24;
    TEdit *EdtCOD2;
        TPanel *Panel10;
    TEdit *EdtCOD1;
        TPanel *Panel22;
        TPanel *Panel16;
    TEdit *EdtCOD4;
        TPanel *Panel18;
        TPanel *Panel25;
    TLabel *LblA1;
    TLabel *LblB1;
    TLabel *LblF1;
    TLabel *LblF2;
    TLabel *LblF3;
    TLabel *LblE1;
    TLabel *LblD1;
    TLabel *LblG1;
    TLabel *LblG2;
    TLabel *LblH1;
    TLabel *LblG3;
    TLabel *LblG4;
    TLabel *LblI1;
    TLabel *LblK1;
        TBevel *Bevel2;
    TPanel *Pnl01;
    TEdit *Edt01;
    TPanel *Pnl03;
    TEdit *Edt03;
    TPanel *Pnl04;
    TEdit *Edt04;
    TEdit *Edt05;
    TPanel *Pnl05;
    TPanel *Pnl06;
    TEdit *Edt06;
    TPanel *Pnl07;
    TPanel *Pnl08;
    TPanel *Pnl09;
    TComboBox *ComBox09;
    TPanel *Pnl10;
    TPanel *Pnl12;
    TPanel *Pnl13;
    TPanel *PnlA;
    TCheckBox *ChkBoxA;
    TCheckBox *ChkBoxB;
    TCheckBox *ChkBoxF;
    TCheckBox *ChkBoxE;
    TCheckBox *ChkBoxD;
    TCheckBox *ChkBoxG;
    TCheckBox *ChkBoxH;
    TCheckBox *ChkBoxI;
    TCheckBox *ChkBoxJ;
    TCheckBox *ChkBoxK;
    TCheckBox *ChkBoxL;
    TPanel *PnlB;
    TPanel *PnlF;
    TPanel *PnlE;
    TComboBox *ComBoxE2;
    TPanel *PnlD;
    TPanel *PnlG;
    TPanel *PnlH;
    TComboBox *ComBoxH3;
    TPanel *PnlI;
    TPanel *PnlJ;
    TPanel *PnlK;
    TPanel *PnlL;
    TPanel *PnlADDYMD1;
    TPanel *PnlUPDYMD1;
    TPanel *PnlUPDCNT1;
    TPanel *PnlADDYMD2;
    TPanel *PnlUPDYMD2;
    TPanel *PnlUPDCNT2;
        TPanel *Panel47;
        TPanel *Panel48;
        TPanel *Panel49;
        TPanel *Panel50;
        TPanel *Panel51;
        TPanel *Panel52;
        TPanel *Panel53;
        TPanel *Panel54;
        TPanel *Panel55;
        TPanel *Panel56;
        TPanel *Panel57;
        TBevel *Bevel4;
        TBevel *Bevel5;
        TBevel *Bevel6;
        TBevel *Bevel7;
    TPanel *Pnl11;
    TComboBox *ComBox11;
    TEdit *Edt02;
    TPanel *PnlC;
    TLabel *LblC1;
    TCheckBox *ChkBoxC;
        TPanel *Panel66;
    TLabel *LblJ1;
    TLabel *LblL1;
    TPanel *Panel67;
    TCheckBox *ChkBoxM;
    TPanel *PnlM;
    TLabel *LblM1;
    TLabel *LblG5;
    TLabel *LblH2;
    TLabel *LblH3;
    TBevel *Bevel3;
    TDatabase *Database1;
    TQuery *Query1;
    TNumberEdit *Edt08;
    TNumberEdit *Edt10;
    TNumberEdit *Edt12;
    TNumberEdit *Edt13;
    TNumberEdit *ChkEdtA;
    TNumberEdit *ChkEdtB;
    TNumberEdit *ChkEdtC;
    TNumberEdit *ChkEdtD;
    TNumberEdit *ChkEdtE;
    TNumberEdit *ChkEdtF;
    TNumberEdit *ChkEdtG;
    TNumberEdit *ChkEdtH;
    TNumberEdit *ChkEdtI;
    TNumberEdit *ChkEdtJ;
    TNumberEdit *ChkEdtK;
    TNumberEdit *ChkEdtL;
    TNumberEdit *ChkEdtM;
    TNumberEdit *EdtA1;
    TNumberEdit *EdtA2;
    TNumberEdit *EdtB1;
    TNumberEdit *EdtB2;
    TNumberEdit *EdtC1;
    TNumberEdit *EdtC2;
    TNumberEdit *EdtF1;
    TNumberEdit *EdtF2;
    TNumberEdit *EdtF3;
    TNumberEdit *EdtE1;
    TNumberEdit *EdtE3;
    TNumberEdit *EdtD1;
    TNumberEdit *EdtD2;
    TNumberEdit *EdtG1;
    TNumberEdit *EdtG2;
    TNumberEdit *EdtG3;
    TNumberEdit *EdtG4;
    TNumberEdit *EdtH1;
    TNumberEdit *EdtH2;
    TNumberEdit *EdtH4;
    TNumberEdit *EdtI1;
    TNumberEdit *EdtI2;
    TNumberEdit *EdtJ1;
    TNumberEdit *EdtJ2;
    TNumberEdit *EdtK1;
    TNumberEdit *EdtK2;
    TNumberEdit *EdtL1;
    TNumberEdit *EdtL2;
    TNumberEdit *EdtM1;
    TNumberEdit *EdtM2;
    TEdit *Edt07;
    TLabel *LblA2;
    TLabel *LblB2;
    TLabel *LblC2;
    TLabel *LblM2;
    TLabel *LblI2;
    TLabel *LblJ2;
    TLabel *LblK2;
    TLabel *LblL2;
    TLabel *LblF4;
    TLabel *LblE2;
    TEdit *EdtF4;
    TPanel *PnlUPDCHR1;
    TPanel *PnlUPDCHR2;
    TPanel *PnlREVCNT1;
    TPanel *PnlREVCNT2;
    TPanel *PnlMEMO;
    TEdit *EdtMEMO;
    TPanel *Panel3;
    TCheckBox *CheckBoxRireki;
    TBevel *Bevel33;
    TQuery *Query2;
    TPanel *PnlN;
    TNumberEdit *EdtN1;
    TLabel *LblN1;
    TNumberEdit *EdtN2;
    TComboBox *ComBoxN3;
    TNumberEdit *EdtN4;
    TLabel *LblN2;
    TLabel *LblN3;
    TPanel *Panel4;
    TCheckBox *ChkBoxN;
    TNumberEdit *ChkEdtN;
    void __fastcall FormCreate(TObject *Sender);
    void __fastcall BtnF01Click(TObject *Sender);
    void __fastcall BtnF05Click(TObject *Sender);
    void __fastcall BtnF12Click(TObject *Sender);
    void __fastcall BtnF07Click(TObject *Sender);
    void __fastcall SGr1SelectCell(TObject *Sender, int ACol, int ARow,
          bool &CanSelect);
    void __fastcall ChkBoxClick(TObject *Sender);
    void __fastcall BtnF08Click(TObject *Sender);
    void __fastcall FormKeyDown(TObject *Sender, WORD &Key,
          TShiftState Shift);
    void __fastcall SGr1KeyPress(TObject *Sender, char &Key);
    void __fastcall BtnF02Click(TObject *Sender);
    void __fastcall BtnF03Click(TObject *Sender);
    void __fastcall FormCloseQuery(TObject *Sender, bool &CanClose);
    void __fastcall BtnF10Click(TObject *Sender);
    void __fastcall BtnF11Click(TObject *Sender);
    void __fastcall BtnF09Click(TObject *Sender);
    void __fastcall BtnF06Click(TObject *Sender);
    void __fastcall ComBox11Change(TObject *Sender);
    void __fastcall FormEnter(TObject *Sender);
    void __fastcall FormKeyPress(TObject *Sender, char &Key);
    void __fastcall ValueChenge(TObject *Sender);
    void __fastcall Edt10Change(TObject *Sender);
    void __fastcall SGr1DrawCell(TObject *Sender, int ACol, int ARow,
          TRect &Rect, TGridDrawState State);
    void __fastcall ComBox09Change(TObject *Sender);
private:	// ユーザー宣言

    // ユーザー情報
    int     USER_COD;
    String  USER_NAM;
    String  BUMO_COD;
    String  BUMO_NAM;

    bool    DataSave;

    void __fastcall InitEdt();
    void __fastcall InitEdt2(bool status);
    void __fastcall EdtStatus(int tag, bool status);
    bool __fastcall AddData();
    bool __fastcall DelData();
    bool __fastcall CollectData(String OldKey);
    void __fastcall SetZAISHITSU(int flag,String KeyStr );

    struct TKM02{                // 製品規格マスタ
        AnsiString DTKSCOD;      // 得意先コード
        AnsiString DTKSNAM;      // 得意先名称
        AnsiString DTKSHIN;      // 得意先品番
        AnsiString HINBAN;       // 自社品番
        AnsiString ZISCOD;       // 材質コード
        AnsiString ZISNAM;       // 材質名
        AnsiString SYOSCOD;      // 焼成コード
        int        SORTKEY;      // ソートキー
        int        KEIJKBN;      // 形状区分
        int        SK_LD_LNG;    // 測定区分　線長さ
        int        SK_BURASI;    // 測定区分　ブラシ幅
        int        SK_BURASIT;   // 測定区分　ブラシ幅縦押し
        int        SK_LD_TR;     // 測定区分　線取付抵抗
        int        SK_LD_HP;     // 測定区分　線引張強度
        int        SK_BOTAI;     // 測定区分　母体比重
        int        SK_KOYU;      // 測定区分　固有抵抗
        int        SK_MAGE;      // 測定区分　抗折力
        int        SK_HSC_A;     // 測定区分　HsC硬度（圧面）
        int        SK_HSC_S;     // 測定区分　HsC硬度（側面）
        int        SK_HSD_A;     // 測定区分　HsD硬度（圧面）
        int        SK_HSD_S;     // 測定区分　HsD硬度（側面）
        int        SK_ZAKUT;     // 測定区分　座屈
        int        HIST_SOKUT;   // ヒストグラム（測定数）
        int        HIST_KIKAK;   // ヒストグラム（規格）
        double     HIST_MIN;     // ヒストグラム（下限）
        double     HIST_MAX;     // ヒストグラム（上限）
        double     LD_LNG_MIN;   // リード線長さ（下限）
        double     LD_LNG_MAX;   // リード線長さ（上限）
        double     BURASI_MIN;   // ブラシ幅（下限）
        double     BURASI_MAX;   // ブラシ幅（上限）
        double     BURASIT_MIN;  // ブラシ幅縦押し（下限）
        double     BURASIT_MAX;  // ブラシ幅縦押し（上限）
        double     LD_TR_DENA;   // リード取付抵抗（電圧）
        int        LD_TR_DENR;   // リード取付抵抗（電流）
        int        LD_TR_TIME;   // リード取付抵抗（時間）
        AnsiString LD_TR_TYPE;   // リード取付抵抗（TYPE）
        double     LD_HP_KYO;    // リード線引張強度
        int        LD_HP_TAN;    // リード線引張強度（単位）
        int        LD_HP_SPD;    // リード線引張強度（速度）
        double     BOTAI_MIN;    // 母体比重（下限）
        double     BOTAI_MAX;    // 母体比重（上限）
        int        KOYU_MIN;     // 固有抵抗率（下限）
        int        KOYU_MAX;     // 固有抵抗率（上限）
        double     KOYU_DEN;     // 固有抵抗率（電流）
        int        KOYU_PRO;     // 固有抵抗率（プローブ）
        double     MAGE_MIN;     // 曲げ強度（下限）
        double     MAGE_MAX;     // 曲げ強度（上限）
        int        MAGE_TAN;     // 曲げ強度（単位）
        double     MAGE_SPAN;    // 曲げ強度（スパン）
        int        HSC_A_MIN;    // HsC硬度 圧面（下限）
        int        HSC_A_MAX;    // HsC硬度 圧面（上限）
        int        HSC_S_MIN;    // HsC硬度 側面（下限）
        int        HSC_S_MAX;    // HsC硬度 側面（上限）
        double     HSD_A_MIN;    // HsD硬度 圧面（下限）
        double     HSD_A_MAX;    // HsD硬度 圧面（上限）
        double     HSD_S_MIN;    // HsD硬度 側面（下限）
        double     HSD_S_MAX;    // HsD硬度 側面（上限）
        int        ZAKUT_MIN;    // 座屈（下限）
        int        ZAKUT_MAX;    // 座屈（上限）
        AnsiString ADDYMD;       // 登録日
        AnsiString ADDTIM;       // 登録時間
        AnsiString UPDYMD;       // 変更日
        AnsiString UPDTIM;       // 変更時間
        int        UPDCHR;       // 更新者
        int        UPDCNT;       // 更新回数
        int        REVCNT;       // 改訂番号
        AnsiString MEMO;         // 備考                    //2002/11/21 E.Takase Add
        int        SK_MAGEG;     // 測定区分　現物曲げ強度  //2002/12/04 E.Takase Add
        double     MAGEG_MIN;    // 現物曲げ強度（下限）    //2002/12/04 E.Takase Add
        double     MAGEG_MAX;    // 現物曲げ強度（上限）    //2002/12/04 E.Takase Add
        int        MAGEG_TAN;    // 現物曲げ強度（単位）    //2002/12/04 E.Takase Add
        double     MAGEG_SPAN;   // 現物曲げ強度（スパン）  //2002/12/04 E.Takase Add
    }KM02;

    void __fastcall GetSGrData(int ARow);
    void __fastcall GetEdtData(void);
    void __fastcall SetEdtData(int ARow);
public:		// ユーザー宣言
    TClipboard *ClpBrd;
    __fastcall TForm1(TComponent* Owner);
    void __fastcall ExtractCode(AnsiString str);
    int __fastcall UpdRirekiNo(int ARow);
    void __fastcall InsSGrRirekiData(void);
    AnsiString __fastcall GetTANNAM(AnsiString strTANSYA);
    AnsiString __fastcall StrReplace(AnsiString str, AnsiString a, AnsiString b);

};
//---------------------------------------------------------------------------
extern PACKAGE TForm1 *Form1;
//---------------------------------------------------------------------------
#endif
